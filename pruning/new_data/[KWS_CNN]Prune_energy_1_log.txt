
==> Dump Arguments:
pruning method: energy
visible gpus: 4
sensitivity analysis: OFF
overall pruning ratio: 0.2
stage: 1

0
0

==> Setting params:
batch_size : 16
test_batch_size : 16
epochs : 150
lr_epochs : 50
lr : 0.0005
momentum : 0.9
weight_decay : 0.0001
no_cuda : False
seed : 1
log_interval : 100
arch : KWS_CNN_S
pretrained : saved_models/energy/KWS_CNN_S/stage_0.pth.tar
evaluate : False
retrain : False
prune : energy
prune_shape : vector
prune_target : None
stage : 1
debug : 1
candidates_pruning_ratios : [0.0, 0.0, 0.0, 0.0, 0.0]
gpus : [0]
visible_gpus : 4
learning_rate_list : [0.0005, 0.0001, 2e-05]
sa : True
sen_ana : False
overall_pruning_ratio : 0.2
cuda : False
====================

Load cached data ...
Load cached data ...
Load cached data ...
KWS_CNN_S(
  (conv1): Conv2d(1, 28, kernel_size=(10, 4), stride=(1, 1))
  (bn1): BatchNorm2d(28, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (conv2): Conv2d(28, 28, kernel_size=(10, 4), stride=(2, 1))
  (bn2): BatchNorm2d(28, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (ip1): Linear(in_features=1792, out_features=16, bias=True)
  (ip2): Linear(in_features=16, out_features=128, bias=True)
  (bn3): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (ip3): Linear(in_features=128, out_features=12, bias=True)
  (relu): ReLU(inplace=True)
)
==> Start pruning ...
[0.016542486319989627, 0.07457308736540066, 0.0007886062316824609, 9.3481273521494e-05, 5.959060644891683e-05]
===> Starting Simulated Annealing...
[Iter 0] cur_temp: 100.00 | stop_temp: 20.00 | Loss: -inf | Best perf: -inf[Iter 1] cur_temp: 90.00 | stop_temp: 20.00 | Loss: -4.7594 | Best perf: -4.7594[Iter 2] cur_temp: 81.00 | stop_temp: 20.00 | Loss: -6.0324 | Best perf: -4.7594[Iter 3] cur_temp: 72.90 | stop_temp: 20.00 | Loss: -5.2655 | Best perf: -4.7594[Iter 4] cur_temp: 65.61 | stop_temp: 20.00 | Loss: -21.3318 | Best perf: -4.7594[Iter 5] cur_temp: 59.05 | stop_temp: 20.00 | Loss: -3.2897 | Best perf: -3.2897[Iter 6] cur_temp: 53.14 | stop_temp: 20.00 | Loss: -5.5624 | Best perf: -3.2897[Iter 7] cur_temp: 47.83 | stop_temp: 20.00 | Loss: -3.2576 | Best perf: -3.2576[Iter 8] cur_temp: 43.05 | stop_temp: 20.00 | Loss: -1.2938 | Best perf: -1.2938[Iter 9] cur_temp: 38.74 | stop_temp: 20.00 | Loss: -5.9900 | Best perf: -1.2938[Iter 10] cur_temp: 34.87 | stop_temp: 20.00 | Loss: -6.1814 | Best perf: -1.2938[Iter 11] cur_temp: 31.38 | stop_temp: 20.00 | Loss: -9.9037 | Best perf: -1.2938[Iter 12] cur_temp: 28.24 | stop_temp: 20.00 | Loss: -5.8341 | Best perf: -1.2938[Iter 13] cur_temp: 25.42 | stop_temp: 20.00 | Loss: -5.8830 | Best perf: -1.2938[Iter 14] cur_temp: 22.88 | stop_temp: 20.00 | Loss: -5.6276 | Best perf: -1.2938[Iter 15] cur_temp: 20.59 | stop_temp: 20.00 | Loss: -5.9463 | Best perf: -1.2938
------------------------------------------------------------------
- Intermittent-aware weight pruning info:
- Layer 0:        308 /       1120 (27.5%) weights are pruned
- Layer 1:      15456 /      31360 (49.3%) weights are pruned
- Layer 2:       6912 /      28672 (24.1%) weights are pruned
- Layer 3:        128 /       2048 ( 6.2%) weights are pruned
- Layer 4:          0 /       1536 ( 0.0%) weights are pruned
- Total  :      22804 /      64736 (35.2%) weights are pruned
------------------------------------------------------------------

[Epoch: 1| Loss: 0.4443| Accuracy: 86.46| Best Accuracy: 86.46]
[Epoch: 2| Loss: 0.4324| Accuracy: 86.91| Best Accuracy: 86.91]
[Epoch: 3| Loss: 0.4396| Accuracy: 86.48| Best Accuracy: 86.91]
[Epoch: 4| Loss: 0.4520| Accuracy: 86.09| Best Accuracy: 86.91]
[Epoch: 5| Loss: 0.4445| Accuracy: 86.63| Best Accuracy: 86.91]
[Epoch: 6| Loss: 0.4669| Accuracy: 86.13| Best Accuracy: 86.91]
[Epoch: 7| Loss: 0.4596| Accuracy: 86.65| Best Accuracy: 86.91]
[Epoch: 8| Loss: 0.4691| Accuracy: 86.16| Best Accuracy: 86.91]
[Epoch: 9| Loss: 0.4613| Accuracy: 86.44| Best Accuracy: 86.91]
[Epoch: 10| Loss: 0.4761| Accuracy: 86.56| Best Accuracy: 86.91]
[Epoch: 11| Loss: 0.4839| Accuracy: 85.71| Best Accuracy: 86.91]
[Epoch: 12| Loss: 0.4874| Accuracy: 85.71| Best Accuracy: 86.91]
[Epoch: 13| Loss: 0.4681| Accuracy: 86.61| Best Accuracy: 86.91]
[Epoch: 14| Loss: 0.4729| Accuracy: 86.30| Best Accuracy: 86.91]
[Epoch: 15| Loss: 0.4968| Accuracy: 85.89| Best Accuracy: 86.91]
[Epoch: 16| Loss: 0.5047| Accuracy: 86.22| Best Accuracy: 86.91]
[Epoch: 17| Loss: 0.5170| Accuracy: 85.91| Best Accuracy: 86.91]
[Epoch: 18| Loss: 0.5236| Accuracy: 85.21| Best Accuracy: 86.91]
[Epoch: 19| Loss: 0.5028| Accuracy: 85.95| Best Accuracy: 86.91]
[Epoch: 20| Loss: 0.5045| Accuracy: 85.75| Best Accuracy: 86.91]
[Epoch: 21| Loss: 0.5283| Accuracy: 85.71| Best Accuracy: 86.91]
[Epoch: 22| Loss: 0.5146| Accuracy: 85.89| Best Accuracy: 86.91]
[Epoch: 23| Loss: 0.5579| Accuracy: 85.52| Best Accuracy: 86.91]
[Epoch: 24| Loss: 0.5130| Accuracy: 85.48| Best Accuracy: 86.91]
[Epoch: 25| Loss: 0.5294| Accuracy: 85.64| Best Accuracy: 86.91]
[Epoch: 26| Loss: 0.5239| Accuracy: 85.28| Best Accuracy: 86.91]
[Epoch: 27| Loss: 0.5315| Accuracy: 85.66| Best Accuracy: 86.91]
[Epoch: 28| Loss: 0.5399| Accuracy: 85.56| Best Accuracy: 86.91]
[Epoch: 29| Loss: 0.5569| Accuracy: 84.91| Best Accuracy: 86.91]
[Epoch: 30| Loss: 0.5148| Accuracy: 85.75| Best Accuracy: 86.91]
[Epoch: 31| Loss: 0.5440| Accuracy: 85.52| Best Accuracy: 86.91]
[Epoch: 32| Loss: 0.5499| Accuracy: 85.79| Best Accuracy: 86.91]
[Epoch: 33| Loss: 0.5736| Accuracy: 85.81| Best Accuracy: 86.91]
[Epoch: 34| Loss: 0.5827| Accuracy: 84.97| Best Accuracy: 86.91]
[Epoch: 35| Loss: 0.5680| Accuracy: 85.19| Best Accuracy: 86.91]
[Epoch: 36| Loss: 0.5632| Accuracy: 85.19| Best Accuracy: 86.91]
[Epoch: 37| Loss: 0.5613| Accuracy: 85.46| Best Accuracy: 86.91]
[Epoch: 38| Loss: 0.5782| Accuracy: 85.75| Best Accuracy: 86.91]
[Epoch: 39| Loss: 0.5844| Accuracy: 85.38| Best Accuracy: 86.91]
[Epoch: 40| Loss: 0.5389| Accuracy: 85.75| Best Accuracy: 86.91]
[Epoch: 41| Loss: 0.5559| Accuracy: 85.66| Best Accuracy: 86.91]
[Epoch: 42| Loss: 0.5721| Accuracy: 85.28| Best Accuracy: 86.91]
[Epoch: 43| Loss: 0.5803| Accuracy: 85.36| Best Accuracy: 86.91]
[Epoch: 44| Loss: 0.5935| Accuracy: 84.81| Best Accuracy: 86.91]
[Epoch: 45| Loss: 0.5600| Accuracy: 85.85| Best Accuracy: 86.91]
[Epoch: 46| Loss: 0.5679| Accuracy: 85.87| Best Accuracy: 86.91]
[Epoch: 47| Loss: 0.5762| Accuracy: 85.46| Best Accuracy: 86.91]
[Epoch: 48| Loss: 0.5773| Accuracy: 85.30| Best Accuracy: 86.91]
[Epoch: 49| Loss: 0.5965| Accuracy: 85.13| Best Accuracy: 86.91]
adjusting learning rate to 0.0005 ...
[Epoch: 50| Loss: 0.6027| Accuracy: 85.15| Best Accuracy: 86.91]
[Epoch: 51| Loss: 0.5983| Accuracy: 85.24| Best Accuracy: 86.91]
[Epoch: 52| Loss: 0.6035| Accuracy: 85.21| Best Accuracy: 86.91]
[Epoch: 53| Loss: 0.5935| Accuracy: 85.07| Best Accuracy: 86.91]
[Epoch: 54| Loss: 0.6155| Accuracy: 85.40| Best Accuracy: 86.91]
[Epoch: 55| Loss: 0.5936| Accuracy: 85.21| Best Accuracy: 86.91]
[Epoch: 56| Loss: 0.5974| Accuracy: 85.11| Best Accuracy: 86.91]
[Epoch: 57| Loss: 0.5876| Accuracy: 85.28| Best Accuracy: 86.91]
[Epoch: 58| Loss: 0.5868| Accuracy: 85.28| Best Accuracy: 86.91]
[Epoch: 59| Loss: 0.6098| Accuracy: 84.54| Best Accuracy: 86.91]
[Epoch: 60| Loss: 0.6287| Accuracy: 85.17| Best Accuracy: 86.91]
[Epoch: 61| Loss: 0.6174| Accuracy: 85.07| Best Accuracy: 86.91]
[Epoch: 62| Loss: 0.5985| Accuracy: 85.21| Best Accuracy: 86.91]
[Epoch: 63| Loss: 0.6332| Accuracy: 85.09| Best Accuracy: 86.91]
[Epoch: 64| Loss: 0.5963| Accuracy: 85.03| Best Accuracy: 86.91]
[Epoch: 65| Loss: 0.6103| Accuracy: 85.44| Best Accuracy: 86.91]
[Epoch: 66| Loss: 0.6073| Accuracy: 85.05| Best Accuracy: 86.91]
[Epoch: 67| Loss: 0.5985| Accuracy: 85.50| Best Accuracy: 86.91]
[Epoch: 68| Loss: 0.6123| Accuracy: 85.26| Best Accuracy: 86.91]
[Epoch: 69| Loss: 0.9400| Accuracy: 76.36| Best Accuracy: 86.91]
[Epoch: 70| Loss: 0.6547| Accuracy: 84.58| Best Accuracy: 86.91]
[Epoch: 71| Loss: 0.6268| Accuracy: 85.40| Best Accuracy: 86.91]
[Epoch: 72| Loss: 0.6431| Accuracy: 85.13| Best Accuracy: 86.91]
[Epoch: 73| Loss: 0.6234| Accuracy: 85.44| Best Accuracy: 86.91]
[Epoch: 74| Loss: 0.6475| Accuracy: 84.85| Best Accuracy: 86.91]
[Epoch: 75| Loss: 0.6725| Accuracy: 84.01| Best Accuracy: 86.91]
[Epoch: 76| Loss: 0.6132| Accuracy: 85.50| Best Accuracy: 86.91]
[Epoch: 77| Loss: 0.6316| Accuracy: 85.58| Best Accuracy: 86.91]
[Epoch: 78| Loss: 0.6455| Accuracy: 85.17| Best Accuracy: 86.91]
[Epoch: 79| Loss: 0.6462| Accuracy: 85.03| Best Accuracy: 86.91]
[Epoch: 80| Loss: 0.6392| Accuracy: 85.19| Best Accuracy: 86.91]
[Epoch: 81| Loss: 0.6573| Accuracy: 85.03| Best Accuracy: 86.91]
[Epoch: 82| Loss: 0.6151| Accuracy: 85.07| Best Accuracy: 86.91]
[Epoch: 83| Loss: 0.6478| Accuracy: 84.93| Best Accuracy: 86.91]
[Epoch: 84| Loss: 0.6272| Accuracy: 85.19| Best Accuracy: 86.91]
[Epoch: 85| Loss: 0.6211| Accuracy: 85.62| Best Accuracy: 86.91]
[Epoch: 86| Loss: 0.6480| Accuracy: 84.46| Best Accuracy: 86.91]
[Epoch: 87| Loss: 0.6550| Accuracy: 85.44| Best Accuracy: 86.91]
[Epoch: 88| Loss: 0.6310| Accuracy: 84.85| Best Accuracy: 86.91]
[Epoch: 89| Loss: 0.6437| Accuracy: 85.28| Best Accuracy: 86.91]
[Epoch: 90| Loss: 0.6348| Accuracy: 85.44| Best Accuracy: 86.91]
[Epoch: 91| Loss: 0.6596| Accuracy: 84.87| Best Accuracy: 86.91]
[Epoch: 92| Loss: 0.6630| Accuracy: 84.87| Best Accuracy: 86.91]
[Epoch: 93| Loss: 0.6584| Accuracy: 84.91| Best Accuracy: 86.91]
[Epoch: 94| Loss: 0.6610| Accuracy: 84.62| Best Accuracy: 86.91]
[Epoch: 95| Loss: 0.5905| Accuracy: 85.26| Best Accuracy: 86.91]
[Epoch: 96| Loss: 0.6514| Accuracy: 84.87| Best Accuracy: 86.91]
[Epoch: 97| Loss: 0.6235| Accuracy: 85.03| Best Accuracy: 86.91]
[Epoch: 98| Loss: 0.6672| Accuracy: 84.83| Best Accuracy: 86.91]
[Epoch: 99| Loss: 0.6622| Accuracy: 85.15| Best Accuracy: 86.91]
adjusting learning rate to 0.0001 ...
[Epoch: 100| Loss: 0.6275| Accuracy: 85.40| Best Accuracy: 86.91]
[Epoch: 101| Loss: 0.6425| Accuracy: 85.85| Best Accuracy: 86.91]
[Epoch: 102| Loss: 0.6585| Accuracy: 85.24| Best Accuracy: 86.91]
[Epoch: 103| Loss: 0.6388| Accuracy: 85.44| Best Accuracy: 86.91]
[Epoch: 104| Loss: 0.6577| Accuracy: 85.28| Best Accuracy: 86.91]
[Epoch: 105| Loss: 0.6004| Accuracy: 85.60| Best Accuracy: 86.91]
[Epoch: 106| Loss: 0.6470| Accuracy: 85.42| Best Accuracy: 86.91]
[Epoch: 107| Loss: 0.6534| Accuracy: 85.48| Best Accuracy: 86.91]
[Epoch: 108| Loss: 0.6618| Accuracy: 85.64| Best Accuracy: 86.91]
[Epoch: 109| Loss: 0.6747| Accuracy: 85.17| Best Accuracy: 86.91]
[Epoch: 110| Loss: 0.6673| Accuracy: 85.77| Best Accuracy: 86.91]
[Epoch: 111| Loss: 0.6944| Accuracy: 84.99| Best Accuracy: 86.91]
[Epoch: 112| Loss: 0.6776| Accuracy: 85.30| Best Accuracy: 86.91]
[Epoch: 113| Loss: 0.6800| Accuracy: 85.32| Best Accuracy: 86.91]
[Epoch: 114| Loss: 0.7277| Accuracy: 84.66| Best Accuracy: 86.91]
[Epoch: 115| Loss: 0.6647| Accuracy: 85.34| Best Accuracy: 86.91]
[Epoch: 116| Loss: 0.7043| Accuracy: 85.46| Best Accuracy: 86.91]
[Epoch: 117| Loss: 0.7129| Accuracy: 85.26| Best Accuracy: 86.91]
[Epoch: 118| Loss: 0.6986| Accuracy: 85.03| Best Accuracy: 86.91]
[Epoch: 119| Loss: 0.7313| Accuracy: 84.79| Best Accuracy: 86.91]
[Epoch: 120| Loss: 0.7065| Accuracy: 85.36| Best Accuracy: 86.91]
[Epoch: 121| Loss: 0.7234| Accuracy: 85.03| Best Accuracy: 86.91]
[Epoch: 122| Loss: 0.7205| Accuracy: 85.05| Best Accuracy: 86.91]
[Epoch: 123| Loss: 0.7247| Accuracy: 85.38| Best Accuracy: 86.91]
[Epoch: 124| Loss: 0.7182| Accuracy: 85.62| Best Accuracy: 86.91]
[Epoch: 125| Loss: 0.7040| Accuracy: 85.54| Best Accuracy: 86.91]
[Epoch: 126| Loss: 0.7181| Accuracy: 84.72| Best Accuracy: 86.91]
[Epoch: 127| Loss: 0.7168| Accuracy: 84.87| Best Accuracy: 86.91]
[Epoch: 128| Loss: 0.7342| Accuracy: 84.72| Best Accuracy: 86.91]
[Epoch: 129| Loss: 0.7427| Accuracy: 84.27| Best Accuracy: 86.91]
[Epoch: 130| Loss: 0.7000| Accuracy: 84.97| Best Accuracy: 86.91]
[Epoch: 131| Loss: 0.7255| Accuracy: 85.38| Best Accuracy: 86.91]
[Epoch: 132| Loss: 0.7167| Accuracy: 84.99| Best Accuracy: 86.91]
[Epoch: 133| Loss: 0.7185| Accuracy: 84.97| Best Accuracy: 86.91]
[Epoch: 134| Loss: 0.7269| Accuracy: 85.15| Best Accuracy: 86.91]
[Epoch: 135| Loss: 0.7217| Accuracy: 84.93| Best Accuracy: 86.91]
[Epoch: 136| Loss: 0.7200| Accuracy: 85.01| Best Accuracy: 86.91]
[Epoch: 137| Loss: 0.7554| Accuracy: 84.48| Best Accuracy: 86.91]
[Epoch: 138| Loss: 0.7498| Accuracy: 85.09| Best Accuracy: 86.91]
[Epoch: 139| Loss: 0.7460| Accuracy: 84.87| Best Accuracy: 86.91]
[Epoch: 140| Loss: 0.7358| Accuracy: 84.97| Best Accuracy: 86.91]
[Epoch: 141| Loss: 0.7503| Accuracy: 84.89| Best Accuracy: 86.91]
[Epoch: 142| Loss: 0.7383| Accuracy: 84.74| Best Accuracy: 86.91]
[Epoch: 143| Loss: 0.7786| Accuracy: 84.44| Best Accuracy: 86.91]
[Epoch: 144| Loss: 0.7362| Accuracy: 84.74| Best Accuracy: 86.91]
[Epoch: 145| Loss: 0.7468| Accuracy: 84.91| Best Accuracy: 86.91]
[Epoch: 146| Loss: 0.7848| Accuracy: 84.36| Best Accuracy: 86.91]
[Epoch: 147| Loss: 0.7485| Accuracy: 85.11| Best Accuracy: 86.91]
[Epoch: 148| Loss: 0.7670| Accuracy: 85.17| Best Accuracy: 86.91]
[Epoch: 149| Loss: 0.7656| Accuracy: 85.07| Best Accuracy: 86.91]
adjusting learning rate to 2e-05 ...
[Epoch: 150| Loss: 0.7606| Accuracy: 84.42| Best Accuracy: 86.91]
